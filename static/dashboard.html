<!DOCTYPE HTML>
<html>
<head>
    <title>Fermenter Dashboard</title>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){
            namespace = ''; // global namespace

            // the socket.io documentation recommends sending an explicit package upon connection
            // this is especially important when using the global namespace
            var socket = io.connect('http://' + document.domain + ':' + location.port + namespace);
            socket.on('connect', function() {
                socket.emit('socket event', {data: 'Successful connection!'});
            });

            // event handler for server sent data
            // the data is displayed in the "Received" section of the page
            socket.on('stats update', function(msg) {
                $('#start').text('start time: ' + msg.start);
                $('#stop').text('stop time: ' + msg.stop);
                $('#temp').text('temperature: ' + msg.temp + 'deg C');
                $('#heater').text('heater duty cycle: ' + msg.heater);
                $('#impeller').text('impeller duty cycle: ' + msg.impeller);
                $('#calibred').text('red transmittance calibration: ' + msg.optics.calibration.red);
                $('#calibgreen').text('green transmittance calibration: ' + msg.optics.calibration.green);
                $('#ambient').text('ambient light: ' + msg.optics.ambient);
                $('#red').text('red transmittance: ' + msg.optics.red);
                $('#green').text('green transmittance: ' + msg.optics.green);
            });
        });
    </script>
</head>
<body>
    <h1>live-updating system stats</h1>
    <p><a href="./">back</a></p>
    <p id="start"></p>
    <p id="stop"></p>
    <p id="temp"></p>
    <p id="heater"></p>
    <p id="impeller"></p>
    <p id="calibred"></p>
    <p id="calibgreen"></p>
    <p id="ambient"></p>
    <p id="red"></p>
    <p id="green"></p>
</body>
</html>
